# 타임리프(tymeleaf)

### 타임리프란?

**Thymeleaf is a modern server-side Java template engine for both web and standalone environments.**

-> Thymeleaf는 웹 환경과 스탠드 얼론 환경을 모두 지원하는 최신 **서버 자바 템플릿 엔진**입니다.

특징

1.서버 사이드 렌더링(SSR)

백엔드 서버에서 동적으로 HTML을 렌더링할 때 사용

2.내추렬 템플릿(Natural templates)

타임리프로 작성된 템플릿은 HTML을 유지하고 있기 때문에 서버를 통해 열지 않아도 내용을 확인할 수 있어 마크업 결과물을 서버의 렌더링 없이 확인이 가능하다. 대표적인 템플릿 엔진인 JSP는 서버를 통해서 JSP를 렌더링이 되어야지만 그 결과를 확인할 수 있다.

출처 : [Tymeleaf-Official](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-2/dashboard)

### 기본 기능

타임리프 선언

타임리프를 사용하기 위해서는 다음과 같이 html태그 안에 `xmlns:th="http://www.thymeleaf.org"`를 선언해야한다.

```html
<html xmlns:th="http://www.thymeleaf.org">
  ...
</html>
```

#### 텍스트 출력

1.태그안에 `th:text`사용

```html
<span th:text="${data}"></span>
```

2.콘텐츠 영역 내부에 `[[data]]`사용

```html
<span>[[${data}]]</span>
```

**주의점**

HTML 엔티티

HTML은 `<`를 HTML 태그의 시작으로 인식. `<`를 태그의 시작이 아니라 문자로 표현하기 위한 방법

HTML에서 사용하는 문자를 HTML 엔티티로 변환하는것을 escape라고 한다.

`th:text`,`[[...]]`는 기본적으로 escape 제공

ex)

data -> `<b>Strong</b>`

개발자 의도 : Strong 굵게 출력

th:text or [[...]]로 출력시 결과

```text
&lt;b&gt;Strong&lt;b&gt;
```

위와 같은 일 때문에 Unescape 기능 제공

th:text -> th:**u**text

[[...]] -> [**(**...**)**]

#### 변수 - SpringEL

타임리프에서 변수 표현식을 통해 변수 사용 -> 스프링이 제공하는 SpringEL 사용

**`${...}`**

```html
<span th:text="${item.price}"></span>
<span th:text="${item['price']}"></span>
<span th:text="${item.getPrice()}"></span>

<span th:text="${items.get(0).price}"></span>
<span th:text="${items.get(0)['price']}"></span>
<span th:text="${items.get(0).getPrice()}"></span>

<span th:text="${itemMap[item].price}"></span>
<span th:text="${itemMap[item]['price']}"></span>
<span th:text="${itemMap[item].getPrice()}"></span>
```

.price -> price를 프로퍼티 접근 -> getPrice()

['price'] -> price를 프로퍼티 접근 -> getPrice()

getPrice() -> getPrice() 직접 호출

**지역 변수 선언도 가능**

지역 변수로 선언한 변수는 선언한 태그 내부에서만 사용 가능

**`th:with`**

```html
<div th:with="local=${item}">
    <span th:text="${local.price}"></sapn>
</div>
```

#### 기본 객체

request, reponse와 같은 객체를 기본적으로 제공

제공하는 객체들

`${#request}`, `${#reponse}`, `${#session}`, `${#servletContext}`, `${#locale}`

```html
<span th:text="${#request}"></span>
<span th:text="${#response}"></span>
<span th:text="${#session}"></span>
<span th:text="${#servletContext}"></span>
<span th:text="${#locale}"></span>
```

request는 HttpServletRequest를 제공하기 때문에 데이터를 조회하기 위해서는 request.getParameter("data")를 통해서 조회해야하기 때문에 불편하다.

이러한 불편한 점을 해결하기 위해서 param이라는 편의 객체도 제공해준다.

```html
<span th:text="${param.data}"></span>
<span th:text="${session.data}"></span>
<span th:text="${@BeanName.method('data')}"></span>
```

`${param.data}`

#### 자바 8 날짜

자바 8에서 제공하는 LocalDate, LocalDateTime, Instant를 사용하기 위해서는

`thymeleaf-extras-java8time`가 필요하지만 스프링 부트를 통해서 타임리프를 사용하면 자동으로 추가되어있다.

자바 8 날짜 유틸리티 객체

`#temporals`

model= localDateTime : LocalDateTime.now()

```html
<span th:text="${#temporals.day(localDateTime)}"></span>
<span th:text="${#temporals.month(localDateTime)}"></span>
<span th:text="${#temporals.monthName(localDateTime)}"></span>
<span th:text="${#temporals.monthNameShort(localDateTime)}"></span>
<span th:text="${#temporals.year(localDateTime)}"></span>
<span th:text="${#temporals.dayOfWeek(localDateTime)}"></span>
<span th:text="${#temporals.dayOfWeekName(localDateTime)}"></span>
<span th:text="${#temporals.dayOfWeekNameShort(localDateTime)}"></span>
<span th:text="${#temporals.hour(localDateTime)}"></span>
<span th:text="${#temporals.minute(localDateTime)}"></span>
<span th:text="${#temporals.second(localDateTime)}"></span>
<span th:text="${#temporals.nanosecond(localDateTime)}"></span>
```

#### URL

`@{...}` 사용

**param1=kim, param2=20**

```html
<!-- /hello -->
<a th:href="@{/hello}">1</a>
<!-- /hello?param1=kim -->
<a th:href="@{/hello(param1=${param1})}">2</a>
<!-- /hello?username=kim&age=20 -->
<a th:href="@{/hello(username=${param1}, age=${param2})}">3</a>
<!-- /hello/kim -->
<a th:href="@{/hello/{username}(username=${param1})}">4</a>
<!-- /hello/kim?age=20 -->
<a th:href="@{/hello/{username}(username=${param1}, age=${param2})}">5</a>
```

#### 리터널(litral)

소스 코드상에서 고정된 값

타임리프 리터럴은 문자, 숫자, Boolean, null이 존재

타임리프에서 문자 리터럴은 항상 작은 따옴표로 감싸야 한다.

```html
<span th:text="'text'"></span>
```

공백없이 문자가 이어진다면 작은 따옴표 생략 가능

```html
<span th:text="text"></span>
```

```html
<span th:text="'text1' + ' text2'"></span>
<span th:text="'text1 text2'"></span>
<span th:text="'text ' + ${data}"></span>
<span th:text="|text ${data}|"></span>
<!--+ 연산자 사용 대신 리터럴 대체 문법 사용 가능|...|-->
```

<hr/>

## 학습 자료

[인프런)스프링 MVC 2편 - 백엔드 웹 개발 활용 기술](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-mvc-2/dashboard)
